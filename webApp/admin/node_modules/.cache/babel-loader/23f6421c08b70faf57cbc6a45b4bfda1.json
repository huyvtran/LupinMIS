{"ast":null,"code":"var _jsxFileName = \"/home/user/REACT PROJECTS/LFMIS/LupinMIS/webApp/admin/src/coreAdmin/masterData/sectorAndActivity/component/sector/Sector.js\";\nimport React, { Component } from 'react';\nimport $ from 'jquery';\nimport axios from 'axios';\nimport swal from 'sweetalert';\nimport { Route, withRouter } from 'react-router-dom';\nimport _ from 'underscore';\nimport IAssureTable from \"../../../../IAssureTable/IAssureTable.jsx\";\nimport \"./Sector.css\";\naxios.defaults.baseURL = 'http://qalmisapi.iassureit.com';\naxios.defaults.headers.post['Content-Type'] = 'application/json';\n\nclass Sector extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      \"sector\": \"\",\n      \"user_ID\": \"\",\n      \"sector_id\": \"\",\n      fields: {},\n      errors: {},\n      \"tableHeading\": {\n        sector: \"Name of Sector\",\n        actions: 'Action'\n      },\n      \"tableObjects\": {\n        deleteMethod: 'delete',\n        apiLink: '/api/sectors/delete/',\n        editUrl: '/sector-and-activity/',\n        paginationApply: true,\n        searchApply: true\n      },\n      \"dataCount\": 0,\n      \"startRange\": 0,\n      \"limitRange\": 10,\n      \"editId\": props.match.params ? props.match.params.sectorId : ''\n    };\n  }\n\n  handleChange(event) {\n    event.preventDefault();\n    this.setState({\n      \"sector\": this.refs.sector.value\n    });\n    let fields = this.state.fields;\n    fields[event.target.name] = event.target.value;\n    this.setState({\n      fields\n    });\n\n    if (this.validateForm()) {\n      let errors = {};\n      errors[event.target.name] = \"\";\n      this.setState({\n        errors: errors\n      });\n    }\n  }\n\n  isTextKey(evt) {\n    var charCode = evt.which ? evt.which : evt.keyCode;\n\n    if (charCode != 189 && charCode > 32 && (charCode < 65 || charCode > 90)) {\n      evt.preventDefault();\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  SubmitSector(event) {\n    event.preventDefault();\n\n    if (this.validateFormReq() && this.validateForm()) {\n      var sectorValues = {\n        \"sector\": this.refs.sector.value,\n        \"user_ID\": this.state.user_ID\n      };\n      axios.post('/api/sectors', sectorValues).then(response => {\n        this.getData(this.state.startRange, this.state.limitRange);\n        swal({\n          title: response.data.message,\n          text: response.data.message\n        });\n      }).catch(function (error) {\n        console.log(\"error = \", error);\n      });\n      let fields = {};\n      fields[\"sector\"] = \"\";\n      this.setState({\n        \"sector\": \"\",\n        fields: fields\n      });\n    }\n  }\n\n  updateSector(event) {\n    event.preventDefault();\n\n    if (this.refs.sector.value == \"\") {\n      // console.log('state validation');\n      if (this.validateFormReq() && this.validateForm()) {}\n    } else {\n      var sectorValues = {\n        \"sector_ID\": this.state.editId,\n        \"sector\": this.refs.sector.value,\n        \"user_ID\": this.state.user_ID\n      };\n      axios.patch('/api/sectors/update', sectorValues, this.state.editId).then(response => {\n        this.getData(this.state.startRange, this.state.limitRange);\n        swal({\n          title: response.data.message,\n          text: response.data.message\n        });\n        this.setState({\n          editId: ''\n        });\n        this.props.history.push('/sector-and-activity');\n      }).catch(function (error) {\n        console.log(\"error = \", error);\n      });\n      let fields = {};\n      fields[\"sector\"] = \"\";\n      this.setState({\n        \"sector\": \"\",\n        fields: fields\n      });\n    }\n  }\n\n  validateFormReq() {\n    let fields = this.state.fields;\n    let errors = {};\n    let formIsValid = true;\n    $(\"html,body\").scrollTop(0);\n\n    if (!fields[\"sector\"]) {\n      formIsValid = false;\n      errors[\"sector\"] = \"This field is required.\";\n    }\n\n    this.setState({\n      errors: errors\n    });\n    return formIsValid;\n  }\n\n  validateForm() {\n    let fields = this.state.fields;\n    let errors = {};\n    let formIsValid = true;\n\n    if (typeof fields[\"sector\"] !== \"undefined\") {\n      // if (!fields[\"beneficiaryID\"].match(/^(?!\\s*$)[-a-zA-Z0-9_:,.' ']{1,100}$/)) {\n      if (!fields[\"sector\"].match(/^[_A-z]*((-|\\s)*[_A-z])*$|^$/)) {\n        formIsValid = false;\n        errors[\"sector\"] = \"Please enter valid Sector Name.\";\n      }\n    }\n\n    $(\"html,body\").scrollTop(0);\n    this.setState({\n      errors: errors\n    });\n    return formIsValid;\n  }\n\n  componentWillReceiveProps(nextProps) {\n    console.log('componentWillReceiveProps');\n    var editId = nextProps.match.params.sectorId;\n\n    if (nextProps.match.params.sectorId) {\n      this.setState({\n        editId: editId\n      }, () => {\n        this.edit(this.state.editId);\n      });\n    }\n\n    if (nextProps) {\n      this.getLength();\n    }\n  }\n\n  componentDidMount() {\n    console.log('componentDidMount', this.state.tableData);\n    var editId = this.props.match.params.sectorId;\n\n    if (editId) {\n      this.edit(editId);\n    }\n\n    this.getLength();\n    this.getData(this.state.startRange, this.state.limitRange);\n  }\n\n  edit(id) {\n    axios({\n      method: 'get',\n      url: '/api/sectors/' + id\n    }).then(response => {\n      var editData = response.data[0];\n      this.setState({\n        \"sector\": editData.sector\n      }, () => {});\n    }).catch(function (error) {});\n  }\n\n  getData(startRange, limitRange) {\n    var data = {\n      limitRange: limitRange,\n      startRange: startRange // console.log('data', data);\n\n    };\n    axios.post('/api/sectors/list', data).then(response => {\n      console.log('tableData', response.data);\n      this.setState({\n        tableData: response.data\n      });\n    }).catch(function (error) {});\n  }\n\n  getLength() {\n    axios.get('/api/sectors/count').then(response => {\n      // console.log('response', response.data);\n      this.setState({\n        dataCount: response.data.dataLength\n      }, () => {\n        console.log('dataCount', this.state.dataCount);\n      });\n    }).catch(function (error) {});\n  }\n\n  componentWillMount() {\n    console.log('componentWillMount');\n    this.getLength();\n  }\n\n  getSearchText(searchText, startRange, limitRange) {\n    this.setState({\n      tableData: []\n    });\n  }\n\n  componentWillUnmount() {\n    this.setState({\n      \"sector\": \"\",\n      \"editId\": \"\"\n    });\n  }\n\n  render() {\n    console.log('render');\n    return React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"formWrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 formLable mt\",\n      id: \"sectorDetails\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-lg-6 col-md-6 col-sm-12 col-xs-12 addLoc \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"perinfotitle mgtpprsnalinfo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fa fa-map-marker\",\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    }), \"\\xA0\\xA0\\xA0Add Sector\")), React.createElement(\"div\", {\n      className: \"marginBottom col-lg-12 col-md-12 col-sm-12 col-xs-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \" col-lg-12 col-sm-12 col-xs-12 formLable valid_box \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-lg-6 col-md-6 col-sm-6 col-xs-12 \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"formLable\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }, \"Name of Sector\"), React.createElement(\"span\", {\n      className: \"asterix\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }, \"*\"), React.createElement(\"div\", {\n      className: \"col-lg-12 col-sm-12 col-xs-12 input-group inputBox-main \",\n      id: \"sector\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      className: \"form-control inputBox\",\n      placeholder: \"\",\n      ref: \"sector\",\n      name: \"sector\",\n      value: this.state.sector,\n      onKeyDown: this.isTextKey.bind(this),\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"errorMsg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282\n      },\n      __self: this\n    }, this.state.errors.sector)), React.createElement(\"div\", {\n      className: \"col-lg-6 col-md-6 col-sm-6 col-xs-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284\n      },\n      __self: this\n    }, this.state.editId ? React.createElement(\"button\", {\n      className: \" col-lg-4 btn submit pull-right marginT18\",\n      onClick: this.updateSector.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }, \" Update\") : React.createElement(\"button\", {\n      className: \" col-lg-4 btn submit pull-right marginT18\",\n      onClick: this.SubmitSector.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }, \" Submit\")))), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"col-lg-12 \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    }, React.createElement(\"hr\", {\n      className: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"col-lg-12 col-md-12 col-sm-12 col-xs-12 \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298\n      },\n      __self: this\n    }, React.createElement(IAssureTable, {\n      tableHeading: this.state.tableHeading,\n      dataCount: this.state.dataCount,\n      tableData: this.state.tableData,\n      getData: this.getData.bind(this),\n      tableObjects: this.state.tableObjects // getSearchText={this.getSearchText.bind(this)}\n      ,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    })))));\n  }\n\n}\n\nexport default withRouter(Sector);","map":{"version":3,"sources":["/home/user/REACT PROJECTS/LFMIS/LupinMIS/webApp/admin/src/coreAdmin/masterData/sectorAndActivity/component/sector/Sector.js"],"names":["React","Component","$","axios","swal","Route","withRouter","_","IAssureTable","defaults","baseURL","headers","post","Sector","constructor","props","state","fields","errors","sector","actions","deleteMethod","apiLink","editUrl","paginationApply","searchApply","match","params","sectorId","handleChange","event","preventDefault","setState","refs","value","target","name","validateForm","isTextKey","evt","charCode","which","keyCode","SubmitSector","validateFormReq","sectorValues","user_ID","then","response","getData","startRange","limitRange","title","data","message","text","catch","error","console","log","updateSector","editId","patch","history","push","formIsValid","scrollTop","componentWillReceiveProps","nextProps","edit","getLength","componentDidMount","tableData","id","method","url","editData","get","dataCount","dataLength","componentWillMount","getSearchText","searchText","componentWillUnmount","render","bind","tableHeading","tableObjects"],"mappings":"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","sourcesContent":["import React, { Component }   from 'react';\r\nimport $                      from 'jquery';\r\nimport axios                  from 'axios';\r\nimport swal                   from 'sweetalert';\r\nimport {Route, withRouter}    from 'react-router-dom';\r\nimport _                      from 'underscore';\r\nimport IAssureTable           from \"../../../../IAssureTable/IAssureTable.jsx\";\r\nimport \"./Sector.css\";\r\n\r\naxios.defaults.baseURL = 'http://qalmisapi.iassureit.com';\r\naxios.defaults.headers.post['Content-Type'] = 'application/json';\r\n\r\nclass Sector extends Component{\r\n  \r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      \"sector\"              :\"\",\r\n      \"user_ID\"             :\"\",\r\n      \"sector_id\"           :\"\",\r\n      fields                : {},\r\n      errors                : {},\r\n      \"tableHeading\"        : {\r\n        sector              : \"Name of Sector\",\r\n        actions             : 'Action',\r\n      },\r\n      \"tableObjects\"        : {\r\n        deleteMethod        : 'delete',\r\n        apiLink             : '/api/sectors/delete/',\r\n        editUrl             : '/sector-and-activity/',\r\n        paginationApply     : true,\r\n        searchApply         : true,\r\n      },\r\n      \"dataCount\"           : 0,\r\n      \"startRange\"          : 0,\r\n      \"limitRange\"          : 10,\r\n      \"editId\"              : props.match.params ? props.match.params.sectorId : ''\r\n    }\r\n  }\r\n \r\n  handleChange(event){\r\n    event.preventDefault();\r\n    this.setState({\r\n     \"sector\"   : this.refs.sector.value,  \r\n    });\r\n    let fields = this.state.fields;\r\n    fields[event.target.name] = event.target.value;\r\n    this.setState({\r\n      fields\r\n    });\r\n    if (this.validateForm()) {\r\n      let errors = {};\r\n      errors[event.target.name] = \"\";\r\n      this.setState({\r\n        errors: errors\r\n      });\r\n    }\r\n  }\r\n\r\n  isTextKey(evt) {\r\n   var charCode = (evt.which) ? evt.which : evt.keyCode\r\n   if (charCode!=189 && charCode > 32 && (charCode < 65 || charCode > 90) )\r\n   {\r\n    evt.preventDefault();\r\n      return false;\r\n    }\r\n    else{\r\n      return true;\r\n    }\r\n \r\n  }\r\n\r\n  SubmitSector(event){\r\n    event.preventDefault();\r\n    if (this.validateFormReq() && this.validateForm()) {\r\n    var sectorValues= {\r\n    \"sector\"      :this.refs.sector.value,\r\n    \"user_ID\"     : this.state.user_ID,\r\n    };\r\n\r\n    \r\n    axios.post('/api/sectors',sectorValues)\r\n      .then((response)=>{\r\n        this.getData(this.state.startRange, this.state.limitRange);\r\n        swal({\r\n          title : response.data.message,\r\n          text  : response.data.message\r\n        });\r\n      })\r\n      .catch(function(error){\r\n        console.log(\"error = \",error);\r\n      });\r\n      let fields       = {};\r\n      fields[\"sector\"] = \"\";\r\n   \r\n      this.setState({\r\n        \"sector\"  :\"\",\r\n        fields    :fields\r\n      });\r\n    } \r\n  }\r\n\r\n\r\n  updateSector(event){\r\n    event.preventDefault();\r\n    if(this.refs.sector.value ==\"\") {\r\n      // console.log('state validation');\r\n      if (this.validateFormReq() && this.validateForm()) {\r\n      }\r\n    }else{\r\n      var sectorValues= {\r\n        \"sector_ID\"   :this.state.editId,\r\n        \"sector\"      :this.refs.sector.value,\r\n        \"user_ID\"     : this.state.user_ID,\r\n      };\r\n\r\n      \r\n      axios.patch('/api/sectors/update',sectorValues, this.state.editId)\r\n        .then((response)=>{\r\n          this.getData(this.state.startRange, this.state.limitRange);\r\n          swal({\r\n            title : response.data.message,\r\n            text  : response.data.message\r\n          });\r\n          this.setState({\r\n            editId : ''\r\n          })\r\n          this.props.history.push('/sector-and-activity');\r\n        })\r\n        .catch(function(error){\r\n          console.log(\"error = \",error);\r\n        });\r\n        let fields = {};\r\n        fields[\"sector\"] = \"\";\r\n   \r\n      this.setState({\r\n        \"sector\"  :\"\",\r\n        fields:fields\r\n      });\r\n    }     \r\n  }\r\n  validateFormReq() {\r\n    let fields = this.state.fields;\r\n    let errors = {};\r\n    let formIsValid = true;\r\n    $(\"html,body\").scrollTop(0);\r\n      if (!fields[\"sector\"]) {\r\n        formIsValid = false;\r\n        errors[\"sector\"] = \"This field is required.\";\r\n      }     \r\n      this.setState({\r\n        errors: errors\r\n      });\r\n      return formIsValid;\r\n  }\r\n\r\n  validateForm() {\r\n    let fields = this.state.fields;\r\n    let errors = {};\r\n    let formIsValid = true;\r\n      if (typeof fields[\"sector\"] !== \"undefined\") {\r\n        // if (!fields[\"beneficiaryID\"].match(/^(?!\\s*$)[-a-zA-Z0-9_:,.' ']{1,100}$/)) {\r\n        if (!fields[\"sector\"].match(/^[_A-z]*((-|\\s)*[_A-z])*$|^$/)) {\r\n          formIsValid = false;\r\n          errors[\"sector\"] = \"Please enter valid Sector Name.\";\r\n        }\r\n      }\r\n    $(\"html,body\").scrollTop(0);\r\n      this.setState({\r\n        errors: errors\r\n      });\r\n      return formIsValid;\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps){\r\n  console.log('componentWillReceiveProps');\r\n    var editId = nextProps.match.params.sectorId;\r\n    if(nextProps.match.params.sectorId){\r\n      this.setState({\r\n        editId : editId\r\n      },()=>{\r\n        this.edit(this.state.editId);\r\n\r\n      })\r\n    }\r\n    if(nextProps){\r\n      this.getLength();\r\n    }\r\n  }\r\n  \r\n  componentDidMount(){\r\n  console.log('componentDidMount', this.state.tableData);\r\n    var editId = this.props.match.params.sectorId;\r\n    if(editId){      \r\n      this.edit(editId);\r\n    }\r\n    this.getLength();\r\n    this.getData(this.state.startRange, this.state.limitRange);\r\n  }\r\n\r\n  edit(id){\r\n    axios({\r\n      method: 'get',\r\n      url: '/api/sectors/'+id,\r\n    }).then((response)=> {\r\n      var editData = response.data[0];      \r\n      this.setState({\r\n        \"sector\"                :editData.sector,\r\n      },()=>{\r\n        \r\n      });\r\n    }).catch(function (error) {\r\n    });\r\n  }\r\n  \r\n  getData(startRange, limitRange){\r\n    var data = {\r\n      limitRange : limitRange,\r\n      startRange : startRange,\r\n    }\r\n    // console.log('data', data);\r\n     axios.post('/api/sectors/list',data)\r\n    .then((response)=>{\r\n      console.log('tableData', response.data);\r\n      this.setState({\r\n        tableData : response.data\r\n      })\r\n    })\r\n    .catch(function(error){\r\n      \r\n    });\r\n  }\r\n  getLength(){\r\n    axios.get('/api/sectors/count')\r\n    .then((response)=>{\r\n      // console.log('response', response.data);\r\n      this.setState({\r\n        dataCount : response.data.dataLength\r\n      },()=>{\r\n        console.log('dataCount', this.state.dataCount);\r\n      })\r\n    })\r\n    .catch(function(error){\r\n      \r\n    });\r\n  }\r\n  componentWillMount(){\r\n    console.log('componentWillMount');\r\n    this.getLength();\r\n  }\r\n  getSearchText(searchText, startRange, limitRange){\r\n      this.setState({\r\n          tableData : []\r\n      });\r\n  }\r\n  componentWillUnmount(){\r\n    this.setState({\r\n      \"sector\" :\"\",\r\n      \"editId\" : \"\"\r\n    })\r\n  }\r\n\r\n  render() {\r\n  console.log('render');\r\n    return (\r\n      <div className=\"container-fluid\">\r\n        <div className=\"row\">\r\n          <div className=\"formWrapper\">\r\n            <form className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 formLable mt\" id=\"sectorDetails\">\r\n              <div className=\"col-lg-6 col-md-6 col-sm-12 col-xs-12 addLoc \">\r\n                <span className=\"perinfotitle mgtpprsnalinfo\"><i className=\"fa fa-map-marker\" aria-hidden=\"true\"></i>&nbsp;&nbsp;&nbsp;Add Sector</span>\r\n              </div>\r\n              <div className=\"marginBottom col-lg-12 col-md-12 col-sm-12 col-xs-12\"></div>\r\n              <div className=\"row\">\r\n                <div className=\" col-lg-12 col-sm-12 col-xs-12 formLable valid_box \">\r\n                  <div className=\"col-lg-6 col-md-6 col-sm-6 col-xs-12 \">\r\n                    <label className=\"formLable\">Name of Sector</label><span className=\"asterix\">*</span>\r\n                    <div className=\"col-lg-12 col-sm-12 col-xs-12 input-group inputBox-main \" id=\"sector\" >\r\n                     \r\n                      <input type=\"text\" className=\"form-control inputBox\"  placeholder=\"\"ref=\"sector\" name=\"sector\" value={this.state.sector} onKeyDown={this.isTextKey.bind(this)} onChange={this.handleChange.bind(this)} />\r\n                    </div>\r\n                    <div className=\"errorMsg\">{this.state.errors.sector}</div>\r\n                  </div>\r\n                  <div className=\"col-lg-6 col-md-6 col-sm-6 col-xs-12\">\r\n                    {\r\n                      this.state.editId ? \r\n                      <button className=\" col-lg-4 btn submit pull-right marginT18\" onClick={this.updateSector.bind(this)}> Update</button>\r\n                      :\r\n                      <button className=\" col-lg-4 btn submit pull-right marginT18\" onClick={this.SubmitSector.bind(this)}> Submit</button>\r\n                    }\r\n                  </div> \r\n                </div> \r\n              </div><br/>\r\n            </form>    \r\n            <div className=\"col-lg-12 \">\r\n               <hr className=\"\"/>\r\n            </div>\r\n            <div className=\"col-lg-12 col-md-12 col-sm-12 col-xs-12 \">\r\n              <IAssureTable \r\n                tableHeading={this.state.tableHeading}\r\n                dataCount={this.state.dataCount}\r\n                tableData={this.state.tableData}\r\n                getData={this.getData.bind(this)}\r\n                tableObjects={this.state.tableObjects}\r\n                // getSearchText={this.getSearchText.bind(this)}\r\n              />\r\n            </div>              \r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n  }\r\n\r\n}\r\nexport default withRouter(Sector);"]},"metadata":{},"sourceType":"module"}